{% comment %} Build absolute canonical safely using site.url + site.baseurl + page.url {% endcomment %}
{% assign page_canonical = page.url | absolute_url %}
{% assign site_name = site.title | default: "Veer Patta Public School" %}
{% assign page_title = page.title | default: site_name %}
{% assign page_description = page.description | default: "English-medium school in Nokha (since 1994) with LEAD classrooms, NCC, sports, and caring teachers." %}

<!-- Basic meta -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ page_title }} | {{ site_name }}</title>
<meta name="description" content="{{ page_description }}">

<!-- Favicon -->
<link rel="icon" type="image/jpeg" href="{{ '/assets/images/VPPS LOGO ONNLY.jpg' | relative_url }}">

<!-- Canonical -->
<link rel="canonical" href="{{ page_canonical }}">

<!-- Hreflang (English/Hindi alternates) -->
{% assign url_parts = page.url | split: '/' %}
{% assign lang_segment = url_parts[1] %}
{% if lang_segment == 'hi' %}
  {% assign alt_en = page.url | replace_first: '/hi/', '/en/' | absolute_url %}
  {% assign self_url = page.url | absolute_url %}
  <link rel="alternate" href="{{ self_url }}" hreflang="hi">
  <link rel="alternate" href="{{ alt_en }}" hreflang="en">
  <link rel="alternate" href="{{ site.url | append: site.baseurl | append: '/en/' }}" hreflang="x-default">
{% elsif lang_segment == 'en' %}
  {% assign alt_hi = page.url | replace_first: '/en/', '/hi/' | absolute_url %}
  {% assign self_url = page.url | absolute_url %}
  <link rel="alternate" href="{{ self_url }}" hreflang="en">
  <link rel="alternate" href="{{ alt_hi }}" hreflang="hi">
  <link rel="alternate" href="{{ site.url | append: site.baseurl | append: '/en/' }}" hreflang="x-default">
{% endif %}

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="{{ site_name }}">
<meta property="og:title" content="{{ page_title }}">
<meta property="og:description" content="{{ page_description }}">
<meta property="og:url" content="{{ page_canonical }}">
{% if page.og_image %}
  <meta property="og:image" content="{{ page.og_image | absolute_url }}">
{% endif %}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ page_title }}">
<meta name="twitter:description" content="{{ page_description }}">
{% if page.og_image %}
  <meta name="twitter:image" content="{{ page.og_image | absolute_url }}">
{% endif %}

<!-- Robots: noindex for 404 -->
{% if page.url == '/404.html' or page.noindex == true %}
  <meta name="robots" content="noindex, nofollow">
{% endif %}

<!-- Critical CSS - Inline for instant header rendering on 3G -->
<style>
/* Critical header styles - mobile-first for 3G networks */
:root{--brand-blue:#5375E2;--brand-bg:#FEFEFE;--text-color:#1e2430}
*{box-sizing:border-box;margin:0;padding:0}
body{margin:0;font-family:system-ui,-apple-system,sans-serif;background:var(--brand-bg);color:var(--text-color);line-height:1.6}
.site-header{position:sticky;top:0;z-index:1000;background:var(--brand-bg);box-shadow:0 2px 8px rgba(0,0,0,0.1)}
.header-container{display:flex;align-items:center;gap:12px;padding:10px 16px;min-height:70px}
.header-logo{flex-shrink:0}
.school-logo{width:60px;height:60px;display:block;border-radius:8px;object-fit:contain}
.header-brand{flex:1;min-width:0}
.brand-name{font-size:16px;font-weight:700;line-height:1.3;color:var(--brand-blue)}
.desktop-nav,.desktop-lang-switch,.desktop-whatsapp-btn{display:none}
.mobile-menu-btn{display:flex;flex-direction:column;align-items:center;gap:4px;background:transparent;border:none;padding:8px;min-width:56px;min-height:56px;cursor:pointer}
.hamburger{display:flex;flex-direction:column;gap:5px;width:26px}
.hamburger-line{display:block;width:100%;height:3px;background:var(--brand-blue);border-radius:2px}
.menu-text{font-size:11px;font-weight:600;color:var(--brand-blue);text-transform:uppercase}
.mobile-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:1998;opacity:0;visibility:hidden}
.mobile-nav{position:fixed;top:0;right:0;bottom:0;width:min(300px,85vw);background:var(--brand-bg);z-index:1999;transform:translateX(100%);overflow-y:auto;display:flex;flex-direction:column}
.sticky-whatsapp-mobile{position:fixed;right:16px;bottom:16px;z-index:1997;display:flex;width:56px;height:56px;background:#25D366;color:#fff;border-radius:50%;box-shadow:0 4px 16px rgba(0,0,0,0.2)}
@media (min-width:768px){.mobile-menu-btn,.sticky-whatsapp-mobile{display:none}.desktop-nav{display:flex;margin-left:auto}.desktop-lang-switch,.desktop-whatsapp-btn{display:block}}
</style>

<!-- Google Fonts: Poppins (English) & Noto Sans Devanagari (Hindi) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Stylesheets -->
<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
<link rel="stylesheet" href="{{ '/assets/css/animations.css' | relative_url }}">

<!-- JavaScript -->
<script defer src="{{ '/assets/js/main.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/marketing-enhancements.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/media-loader.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/home-media-loader.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/gallery-loader.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/gallery-items.js' | relative_url }}"></script>

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "School",
  "name": "{{ site.school_name | default: 'Veer Patta Public School' }}",
  "description": "{{ site.description | default: 'Bilingual learning environment nurturing leaders of tomorrow.' }}",
  "url": "{{ site.url | append: site.baseurl }}",
  "telephone": "{{ site.school_phone | default: '+919413748575' }}",
  "email": "{{ site.school_email | default: 'veerpatta.school@gmail.com' }}",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Opp. Mela Ground, Amet",
    "addressLocality": "Amet",
    "addressRegion": "Rajasthan",
    "postalCode": "313332",
    "addressCountry": "IN"
  },
  {% if site.school_geo_lat and site.school_geo_lng %}
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "{{ site.school_geo_lat }}",
    "longitude": "{{ site.school_geo_lng }}"
  },
  {% endif %}
  {% if site.school_hours %}
  "openingHours": "{{ site.school_hours }}",
  {% endif %}
  {% if site.school_sameAs %}
  "sameAs": {{ site.school_sameAs | jsonify }},
  {% endif %}
  "logo": "{{ '/assets/images/VPPS LOGO ONNLY.jpg' | absolute_url }}",
  "image": "{{ '/assets/images/VPPS LOGO ONNLY.jpg' | absolute_url }}"
}
</script>

<!-- Page-level WebPage Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ page.title | default: site.title }}",
  "description": "{{ page.description | default: site.description }}",
  "url": "{{ page.url | absolute_url }}",
  "inLanguage": "{{ page.lang | default: 'en' }}",
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ site.title }}",
    "url": "{{ site.url | append: site.baseurl }}"
  }
}
</script>

<!-- PWA Manifest -->
<link rel="manifest" href="{{ '/manifest.webmanifest' | relative_url }}">
<meta name="theme-color" content="#5375E2">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Veer Patta">

