{% comment %} Build absolute canonical safely using site.url + site.baseurl + page.url {% endcomment %}
{% assign page_canonical = page.url | absolute_url %}
{% assign site_name = site.title | default: "Veer Patta Public School" %}
{% assign page_title = page.title | default: site_name %}
{% assign page_description = page.description | default: "English-medium school in Nokha (since 1994) with LEAD classrooms, NCC, sports, and caring teachers." %}

<!-- Basic meta -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ page_title }} | {{ site_name }}</title>
<meta name="description" content="{{ page_description }}">

<!-- Favicon -->
<link rel="icon" type="image/jpeg" href="{{ '/assets/images/VPPS LOGO ONNLY.jpg' | relative_url }}">

<!-- Canonical -->
<link rel="canonical" href="{{ page_canonical }}">

<!-- Hreflang (English/Hindi alternates) -->
{% assign url_parts = page.url | split: '/' %}
{% assign lang_segment = url_parts[1] %}
{% if lang_segment == 'hi' %}
  {% assign alt_en = page.url | replace_first: '/hi/', '/en/' | absolute_url %}
  {% assign self_url = page.url | absolute_url %}
  <link rel="alternate" href="{{ self_url }}" hreflang="hi">
  <link rel="alternate" href="{{ alt_en }}" hreflang="en">
  <link rel="alternate" href="{{ site.url | append: site.baseurl | append: '/en/' }}" hreflang="x-default">
{% elsif lang_segment == 'en' %}
  {% assign alt_hi = page.url | replace_first: '/en/', '/hi/' | absolute_url %}
  {% assign self_url = page.url | absolute_url %}
  <link rel="alternate" href="{{ self_url }}" hreflang="en">
  <link rel="alternate" href="{{ alt_hi }}" hreflang="hi">
  <link rel="alternate" href="{{ site.url | append: site.baseurl | append: '/en/' }}" hreflang="x-default">
{% endif %}

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="{{ site_name }}">
<meta property="og:title" content="{{ page_title }}">
<meta property="og:description" content="{{ page_description }}">
<meta property="og:url" content="{{ page_canonical }}">
{% if page.og_image %}
  <meta property="og:image" content="{{ page.og_image | absolute_url }}">
{% endif %}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ page_title }}">
<meta name="twitter:description" content="{{ page_description }}">
{% if page.og_image %}
  <meta name="twitter:image" content="{{ page.og_image | absolute_url }}">
{% endif %}

<!-- Robots: noindex for 404 -->
{% if page.url == '/404.html' or page.noindex == true %}
  <meta name="robots" content="noindex, nofollow">
{% endif %}

<!-- Google Fonts: Poppins (English) & Noto Sans Devanagari (Hindi) -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Stylesheets -->
<link rel="stylesheet" href="{{ '/assets/css/animations.css' | relative_url }}">

<!-- JavaScript -->
<script defer src="{{ '/assets/js/main.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/marketing-enhancements.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/media-loader.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/home-media-loader.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/gallery-loader.js' | relative_url }}"></script>
<script defer src="{{ '/assets/js/gallery-items.js' | relative_url }}"></script>

<!-- JSON-LD Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "School",
  "name": "{{ site.school_name | default: 'Veer Patta Public School' }}",
  "description": "{{ site.description | default: 'Bilingual learning environment nurturing leaders of tomorrow.' }}",
  "url": "{{ site.url | append: site.baseurl }}",
  "telephone": "{{ site.school_phone | default: '+919413748575' }}",
  "email": "{{ site.school_email | default: 'veerpatta.school@gmail.com' }}",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Opp. Mela Ground, Amet",
    "addressLocality": "Amet",
    "addressRegion": "Rajasthan",
    "postalCode": "313332",
    "addressCountry": "IN"
  },
  {% if site.school_geo_lat and site.school_geo_lng %}
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": "{{ site.school_geo_lat }}",
    "longitude": "{{ site.school_geo_lng }}"
  },
  {% endif %}
  {% if site.school_hours %}
  "openingHours": "{{ site.school_hours }}",
  {% endif %}
  {% if site.school_sameAs %}
  "sameAs": {{ site.school_sameAs | jsonify }},
  {% endif %}
  "logo": "{{ '/assets/images/VPPS LOGO ONNLY.jpg' | absolute_url }}",
  "image": "{{ '/assets/images/VPPS LOGO ONNLY.jpg' | absolute_url }}"
}
</script>

<!-- Page-level WebPage Schema -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "{{ page.title | default: site.title }}",
  "description": "{{ page.description | default: site.description }}",
  "url": "{{ page.url | absolute_url }}",
  "inLanguage": "{{ page.lang | default: 'en' }}",
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ site.title }}",
    "url": "{{ site.url | append: site.baseurl }}"
  }
}
</script>

<!-- PWA Manifest -->
<link rel="manifest" href="{{ '/manifest.webmanifest' | relative_url }}">
<meta name="theme-color" content="#5375E2">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Veer Patta">

